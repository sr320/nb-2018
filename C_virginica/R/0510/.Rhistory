'data/zr2096_4_dedup.sorted.bam',
'data/zr2096_5_dedup.sorted.bam',
'data/zr2096_6_dedup.sorted.bam',
'data/zr2096_6_dedup.sorted.bam',
'data/zr2096_8_dedup.sorted.bam',
'data/zr2096_9_dedup.sorted.bam',
'data/zr2096_10_dedup.sorted.bam'
)
myobj = processBismarkAln(location = file.list, sample.id = list("1","2","3","4","5","6","7","8","9","10"), assembly = "v3", read.context="CpG", mincov=3, treatment = c(0,0,0,0,0,1,1,1,1,1))
getMethylationStats(myobj2[[1]],plot=FALSE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=TRUE)
getMethylationStats(myobj[[1]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1,2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1:2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1.2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1.2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1][2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[10]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
meth=unite(myobj)
View(meth)
View(meth)
getCorrelation(meth,plot=TRUE)
clusterSamples(meth, dist="correlation", method="ward", plot=TRUE)
hc = clusterSamples(meth, dist="correlation", method="ward", plot=FALSE)
PCASamples(meth, screeplot=TRUE)
PCASamples(meth)
PCASamples(meth,screeplot=FALSE, adj.lim=c(0.0004,0.1),
scale=TRUE,center=TRUE,comp=c(1,2),transpose=TRUE,sd.filter=TRUE,
sd.threshold=0.5,filterByQuantile=TRUE,obj.return=FALSE)
data(methylKit)
View(methylDiff.obj)
hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
myDiff=calculateDiffMeth(meth)
hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
View(hyper)
hyper
hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
library(methylKit)
file.list=list(  '/Users/sr320/Desktop/oakl/zr2096_1_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_2_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_3_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_4_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_5_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_6_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_6_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_8_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_9_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_10_dedup.sorted.bam'
)
file.list=list(  '/Users/sr320/Desktop/oakl/zr2096_1_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_2_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_3_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_4_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_5_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_6_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_7_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_8_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_9_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_10_dedup.sorted.bam'
)
myobj = processBismarkAln(location = file.list, sample.id = list("1","2","3","4","5","6","7","8","9","10"), assembly = "v3", read.context="CpG", mincov=10, treatment = c(0,0,0,0,0,1,1,1,1,1))
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=TRUE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
meth=unite(myobj)
getCorrelation(meth,plot=TRUE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
clusterSamples(meth, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth, screeplot=TRUE)
myDiff=calculateDiffMeth(meth)
library(methylKit)
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
myDiff=calculateDiffMeth(meth)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
myobj = processBismarkAln(location = file.list, sample.id = list("1","2","3","4","5","6","7","8","9","10"), assembly = "v3", read.context="CpG", mincov=10, treatment = c(0,0,0,0,0,1,1,1,1,1))
file.list=list(  '/Users/sr320/Desktop/oakl/zr2096_1_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_2_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_3_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_4_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_5_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_6_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_7_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_8_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_9_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_10_dedup.sorted.bam'
)
library(methylKit)
myobj = processBismarkAln(location = file.list, sample.id = list("1","2","3","4","5","6","7","8","9","10"), assembly = "v3", read.context="CpG", mincov=10, treatment = c(0,0,0,0,0,1,1,1,1,1))
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
meth=unite(myobj)
getCorrelation(meth,plot=TRUE)
myDiff=calculateDiffMeth(meth)
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
View(myDiff50p)
View(myDiff50p)
myDiff50p
write.csv(myDiff50p, "../analyses/myDiff50p.csv")
write(myobj,"../analyses/myobj_180427files" )
write(myobj, file = "../analyses/myobj_180427files" )
View(myobj)
View(myobj)
save(myobj, file = "../analyses/myobj_180427files")
library(methylKit)
load(myobj)
load("../analyses/myobj_180427files"")
load("../analyses/myobj_180427files")
#loading library
library(methylKit)
load("../analyses/myobj_180427files")
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
meth=unite(myobj)
getCorrelation(meth,plot=TRUE)
clusterSamples(meth, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth, screeplot=TRUE)
myDiff=calculateDiffMeth(meth)
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
myDiff50p
write.csv(myDiff50p, "../analyses/myDiff50p.csv")
library(readr)
myDiff50p <- read_csv("analyses/myDiff50p.csv")
View(myDiff50p)
library(methylKit)
library(readr)
myDiff50p <- read_csv("analyses/myDiff50p.csv")
library(readr)
myDiff50p <- read_csv("../analyses/myDiff50p.csv")
View(myDiff50p)
View(myDiff50p)
head(myDiff50p)
library(tidyverse)
select(myDiff50p, chr, start, end)
library(tidyverse)
select(myDiff50p, chr, start, end) %>%
write("../analyses/test.bed")
library(tidyverse)
select(myDiff50p, chr, start, end)
dml05251200.bed <- library(tidyverse)
select(myDiff50p, chr, start, end)
library(readr)
myDiff50p <- read_csv("../analyses/myDiff50p.csv")
dml05251200.bed <- select(myDiff50p, chr, start, end)
dml05251200.bed <- select(myDiff50p, chr, start, end)
write.csv(dml05251200.bed, "../analyses/dml05251200.bed")
write.table(myDiff50p, file = "../analyses/myDiff50p.tab", sep = "\t",
row.names = TRUE)
write.table(myDiff50p, file = "../analyses/myDiff50p.txt", sep = "\t",
row.names = TRUE)
library(readr)
myDiff50p <- read_table("../analyses/myDiff50p.tab")
head(myDiff50p)
write.table(myDiff50p, file = "../analyses/myDiff50p.tab", sep = "\t")
library(readr)
myDiff50p <- read_table("../analyses/myDiff50p.tab")
head(myDiff50p)
library(readr)
myDiff50p <- read_table("../analyses/myDiff50p.csv")
library(readr)
myDiff50p <- read_csv("../analyses/myDiff50p.csv")
head(myDiff50p)
dml05251200.bed <- select(myDiff50p, chr, start, end)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed")
dml05251200.bed <- select(myDiff50p, chr, start, end)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = "\t")
dml05251200.bed <- select(myDiff50p, chr, start, end)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = !append)
dml05251200.bed <- select(myDiff50p, chr, start, end)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- select(myDiff50p, chr, start, end + 2, strand)
dml05251200.bed <- select(myDiff50p, chr, start, end, strand) %>% mutate(end + 2)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- select(myDiff50p, chr, start, end, strand) %>% mutate(end2 = end + 2)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- select(myDiff50p, chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- select(myDiff50p, chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>%
arrange(chr, start2, end2, strand)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- select(myDiff50p, chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>%
arrange(chr, start2, end2, strand)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- select(myDiff50p, chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>%
select(chr, start2, end2, strand)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- filter(myDiff50p, strand = "+" %>% (select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(chr, start2, end2, strand)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- filter(myDiff50p, strand = '+' %>% (select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(chr, start2, end2, strand)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- filter(myDiff50p, strand == '+' %>% (select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(chr, start2, end2, strand)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- filter(myDiff50p, strand == + %>% (select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(chr, start2, end2, strand)
dml05251200.bed <- filter(myDiff50p, strand == "+" %>% (select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(chr, start2, end2, strand)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200.bed <- filter(myDiff50p, strand == "+") %>% select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(chr, start2, end2, strand)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(chr, start2, end2, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% select(chr, start, end, strand) %>% mutate(start2 = start -2) %>% select(chr, start2, end, strand)
left_join(dml05251200plus, dml05251200minus, by "X1" )
dml05251200plus <- filter(myDiff50p, strand == "+") %>% select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(chr, start2, end2, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% select(chr, start, end, strand) %>% mutate(start2 = start -2) %>% select(chr, start2, end, strand)
left_join(dml05251200plus, dml05251200minus, by = "X1" )
dml05251200plus <- filter(myDiff50p, strand == "+") %>% select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(X1, chr, start2, end2, strand)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% select(chr, start, end, strand) %>% mutate(start2 = start -1, end2 = end + 1) %>% select(X1, chr, start2, end2, strand)
head(myDiff50p)
View(dml05251200plus)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start2 = start -1, end2 = end + 1) %>% select(Xl, chr, start2, end2, strand)
View(dml05251200plus)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start2 = start -1, end2 = end + 1) %>% select(X1, chr, start2, end2, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start2 = start -2) %>% select(X1, chr, start2, end, strand)
left_join(dml05251200plus, dml05251200minus, by = X1 )
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start2 = start -1, end2 = end + 1, row = row_number()) %>% select(X1, chr, start2, end2, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start2 = start -2) %>% select(X1, chr, start2, end, strand)
left_join(dml05251200plus, dml05251200minus, by = X1 )
View(dml05251200plus)
View(dml05251200minus)
View(dml05251200plus)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start2 = start -1, end2 = end + 1) %>% select(X1, chr, start2, end2, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start2 = start -2) %>% select(X1, chr, start2, end, strand)
left_join(dml05251200plus, dml05251200minus, by = X1 )
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start2 = start -1, end2 = end + 1) %>% select(X1, chr, start2, end2, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start2 = start -2) %>% select(X1, chr, start2, end, strand)
left_join(dml05251200plus, dml05251200minus, by = "X1" )
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
View(dml05251200plus)
View(dml05251200minus)
View(dml05251200plus)
View(dml05251200minus)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start2 = start -1, end2 = end + 1) %>% select(X1, chr, start2, end2, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start2 = start -2) %>% select(X1, chr, start2, end, strand)
bind_rows(dml05251200plus,dml05251200minus)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start2 = start -1, end2 = end + 1) %>% select(X1, chr, start2, end2, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start2 = start -2) %>% select(X1, chr, start2, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus,dml05251200minus)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
View(dml05251200plus)
View(dml05251200minus)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus,dml05251200minus)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus)
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus)
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus)
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
#dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus)
dml05251200.bed <- dml05251200plus
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus) %>% arrange(strand)
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus) %>% arrange(chr, start)
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus) %>% arrange(chr, start)
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus) %>% arrange(chr, start)
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE, int_use_scientific=FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus) %>% arrange(chr, start) %>%
mutate_if(is.numeric, as.integer)
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE, int_use_scientific=FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus) %>% arrange(chr, start) %>%
mutate_if(is.numeric, as.integer)
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus) %>% arrange(chr, start) %>%
mutate_if(is.numeric, as.integer)
#latter was done to refrain from writing as scientific notation
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
dml05251200plus <- filter(myDiff50p, strand == "+") %>% mutate(start = start -1, end = end + 1) %>% select(chr, start, end, strand, meth.diff)
dml05251200minus <- filter(myDiff50p, strand == "-") %>% mutate(start = start -2) %>% select(chr, start, end, strand, meth.diff)
dml05251200.bed <- bind_rows(dml05251200plus, dml05251200minus) %>% arrange(chr, start) %>%
mutate_if(is.numeric, as.integer)
#latter was done to refrain from writing as scientific notation
dml05251200.bed
write_delim(dml05251200.bed, "../analyses/dml05251200.bed",  delim = '\t', col_names = FALSE)
library(methylKit)
file.list=list(  '../../0510/data/zr2096_1_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_2_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_3_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_4_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_5_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_6_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_7_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_8_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_9_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_10_dedup.sorted.bam'
)
file.list=list(  '../../0510/data/zr2096_1_dedup.sorted.bam',
'../../0510/data/zr2096_2_dedup.sorted.bam',
'../../0510/data/zr2096_3_dedup.sorted.bam',
'../../0510/data/zr2096_4_dedup.sorted.bam',
'../../0510/data/zr2096_5_dedup.sorted.bam',
'../../0510/data/zr2096_6_dedup.sorted.bam',
'../../0510/data/zr2096_7_dedup.sorted.bam',
'../../0510/data/zr2096_8_dedup.sorted.bam',
'../../0510/data/zr2096_9_dedup.sorted.bam',
'../../0510/data/zr2096_10_dedup.sorted.bam'
)
View(file.list)
myobj = processBismarkAln(location = file.list, sample.id = list("1","2","3","4","5","6","7","8","9","10"), assembly = "v3", read.context="CpG", mincov=3, treatment = c(0,0,0,0,0,1,1,1,1,1))
save(myobj, file = "../analyses/myobj_0921")
getCoverageStats(myobj_0921[[4]],plot=TRUE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
meth=unite(myobj)
clusterSamples(meth, dist="correlation", method="ward", plot=TRUE)
getCorrelation(meth,plot=TRUE)
PCASamples(meth, screeplot=TRUE)
myDiff=calculateDiffMeth(meth)
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
myDiff50p
filtered.myobj=filterByCoverage(myobj_07_3x,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
filtered.myobj=filterByCoverage(myobj,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
filtered.myobj=filterByCoverage(myobj,lo.count=10,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
filtered.myobj=filterByCoverage(myobj,lo.count=1,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
filtered.myobj=filterByCoverage(myobj,lo.count=8,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
filtered.myobj=filterByCoverage(myobj,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
filtered.myobj=filterByCoverage(myobj,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=95)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
filtered.myobj=filterByCoverage(myobj,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=96)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
filtered.myobj=filterByCoverage(myobj,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
filtered.myobj=filterByCoverage(myobj,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
# Function
tileit <- function(object, win.size=50, step.size=50, cov.bases=3) {
g.meth <- as(object,"GRanges")
chrs <- as.character(unique(seqnames(g.meth)))
grl <- split(g.meth, seqnames(g.meth))
max.length <- max(end(grl))
numTiles <- floor((max.length - (win.size - step.size))/step.size) + 1
starts <- unlist(sapply(numTiles,function(x) 1+0:(x-1)*step.size))
ranges <- IRanges(start=starts, width=rep(win.size,length(starts)))
all.wins <- GRanges(seqnames=Rle(chrs, numTiles), ranges=ranges)
rcounts <- regionCounts(object, all.wins, 0, strand.aware=FALSE)
rcounts.filtered <- rcounts[rcounts$coverage >= cov.bases, ]
return(rcounts.filtered)
}
# Code to run function on methylKitList
new.list <- lapply(filtered.myobj, tileit)
myobj.tiled <- new("methylRawList", new.list, treatment=myobj@treatment)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(filtered.myobj, dist="correlation", method="ward", plot=TRUE)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=10,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
# Function
tileit <- function(object, win.size=100, step.size=100, cov.bases=3) {
g.meth <- as(object,"GRanges")
chrs <- as.character(unique(seqnames(g.meth)))
grl <- split(g.meth, seqnames(g.meth))
max.length <- max(end(grl))
numTiles <- floor((max.length - (win.size - step.size))/step.size) + 1
starts <- unlist(sapply(numTiles,function(x) 1+0:(x-1)*step.size))
ranges <- IRanges(start=starts, width=rep(win.size,length(starts)))
all.wins <- GRanges(seqnames=Rle(chrs, numTiles), ranges=ranges)
rcounts <- regionCounts(object, all.wins, 0, strand.aware=FALSE)
rcounts.filtered <- rcounts[rcounts$coverage >= cov.bases, ]
return(rcounts.filtered)
}
# Code to run function on methylKitList
new.list <- lapply(filtered.myobj, tileit)
myobj.tiled <- new("methylRawList", new.list, treatment=myobj@treatment)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=10,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=95)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=95.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=10000,hi.perc=NULL)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=100000,hi.perc=NULL)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=100,hi.perc=NULL)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=10000,hi.perc=NULL)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=97)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=10,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=20,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
filtered.myobj=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_tile=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_tile)
