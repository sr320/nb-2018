library(methylKit)
file.list=list(  'data/zr2096_1_dedup.sorted.bam',
'data/zr2096_2_dedup.sorted.bam',
'data/zr2096_3_dedup.sorted.bam',
'data/zr2096_4_dedup.sorted.bam',
'data/zr2096_5_dedup.sorted.bam',
'data/zr2096_6_dedup.sorted.bam',
'data/zr2096_6_dedup.sorted.bam',
'data/zr2096_8_dedup.sorted.bam',
'data/zr2096_9_dedup.sorted.bam',
'data/zr2096_10_dedup.sorted.bam'
)
myobj = processBismarkAln(location = file.list, sample.id = list("1","2","3","4","5","6","7","8","9","10"), assembly = "v3", read.context="CpG", mincov=3, treatment = c(0,0,0,0,0,1,1,1,1,1))
getMethylationStats(myobj2[[1]],plot=FALSE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=TRUE)
getMethylationStats(myobj[[1]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1,2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1:2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1.2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1.2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1][2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[10]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
meth=unite(myobj)
View(meth)
View(meth)
getCorrelation(meth,plot=TRUE)
clusterSamples(meth, dist="correlation", method="ward", plot=TRUE)
hc = clusterSamples(meth, dist="correlation", method="ward", plot=FALSE)
PCASamples(meth, screeplot=TRUE)
PCASamples(meth)
PCASamples(meth,screeplot=FALSE, adj.lim=c(0.0004,0.1),
scale=TRUE,center=TRUE,comp=c(1,2),transpose=TRUE,sd.filter=TRUE,
sd.threshold=0.5,filterByQuantile=TRUE,obj.return=FALSE)
data(methylKit)
View(methylDiff.obj)
hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
myDiff=calculateDiffMeth(meth)
hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
View(hyper)
hyper
hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
library(methylKit)
file.list=list(  '/Users/sr320/Desktop/oakl/zr2096_1_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_2_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_3_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_4_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_5_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_6_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_6_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_8_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_9_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_10_dedup.sorted.bam'
)
file.list=list(  '/Users/sr320/Desktop/oakl/zr2096_1_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_2_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_3_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_4_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_5_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_6_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_7_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_8_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_9_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_10_dedup.sorted.bam'
)
myobj = processBismarkAln(location = file.list, sample.id = list("1","2","3","4","5","6","7","8","9","10"), assembly = "v3", read.context="CpG", mincov=10, treatment = c(0,0,0,0,0,1,1,1,1,1))
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=TRUE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
meth=unite(myobj)
getCorrelation(meth,plot=TRUE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
clusterSamples(meth, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth, screeplot=TRUE)
myDiff=calculateDiffMeth(meth)
library(methylKit)
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
myDiff=calculateDiffMeth(meth)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
myobj = processBismarkAln(location = file.list, sample.id = list("1","2","3","4","5","6","7","8","9","10"), assembly = "v3", read.context="CpG", mincov=10, treatment = c(0,0,0,0,0,1,1,1,1,1))
file.list=list(  '/Users/sr320/Desktop/oakl/zr2096_1_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_2_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_3_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_4_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_5_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_6_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_7_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_8_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_9_dedup.sorted.bam',
'/Users/sr320/Desktop/oakl/zr2096_10_dedup.sorted.bam'
)
library(methylKit)
myobj = processBismarkAln(location = file.list, sample.id = list("1","2","3","4","5","6","7","8","9","10"), assembly = "v3", read.context="CpG", mincov=10, treatment = c(0,0,0,0,0,1,1,1,1,1))
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
meth=unite(myobj)
getCorrelation(meth,plot=TRUE)
myDiff=calculateDiffMeth(meth)
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
View(myDiff50p)
View(myDiff50p)
myDiff50p
write.csv(myDiff50p, "../analyses/myDiff50p.csv")
write(myobj,"../analyses/myobj_180427files" )
write(myobj, file = "../analyses/myobj_180427files" )
View(myobj)
View(myobj)
save(myobj, file = "../analyses/myobj_180427files")
library(methylKit)
load(myobj)
load("../analyses/myobj_180427files"")
load("../analyses/myobj_180427files")
#loading library
library(methylKit)
load("../analyses/myobj_180427files")
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj[[1]],plot=FALSE,both.strands=FALSE)
getCoverageStats(myobj[[4]],plot=TRUE,both.strands=FALSE)
meth=unite(myobj)
getCorrelation(meth,plot=TRUE)
clusterSamples(meth, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth, screeplot=TRUE)
myDiff=calculateDiffMeth(meth)
myDiff50p=getMethylDiff(myDiff,difference=50,qvalue=0.01)
myDiff50p
write.csv(myDiff50p, "../analyses/myDiff50p.csv")
